OJ.importJs("oj.data.OjObject");OJ.importJs("oj.events.OjEvent");"use strict";OJ.extendManager("EventManager",OjObject,"OjEventManager",{_events:{},_index:{},_constructor:function(){this._super("OjEventManager","_constructor",arguments);var c,d,b=function(f){if(f&&f.type=="DOMContentLoaded"){a()}else{if(f&&f.type=="load"){a()}else{if(document.readyState){if((/loaded|complete/).test(document.readyState)){a()}else{if(!!document.documentElement.doScroll){try{c||document.documentElement.doScroll("left")}catch(f){return}a()}}}}}},a=function(){if(!c){c=true;if(document.removeEventListener){document.removeEventListener("DOMContentLoaded",b,false)}document.onreadystatechange=null;window.onload=null;clearInterval(d);d=null;window.onDomReady()}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",b,false)}document.onreadystatechange=b;d=setInterval(b,5);window.onload=b;return this},_dispatchEvents:function(a,f,h){if(a.isCanceled()){return}var d=this._events,c=h.id(),g,e,b;a._currentTarget=h;if(d[f]&&d[f][c]){e=d[f][c];for(b in e){g=e[b];if(g&&isFunction(g.callback)){g.callback.call(g.context,a)}}}},_getIndex:function(b,c){var a=this._index;if(!a[b]){a[b]={}}a[b][c[0]+":"+c[1]+":"+c[3]]=c},addEventListener:function(g,e,d,h){h=isString(h)?d[h]:h;var c=this._events,b=g.id(),f=d==window?"window":d.id(),a=f+":"+(h.guid?h.guid:h.guid=OJ.guid());if(!c[e]){c[e]={}}if(!c[e][b]){c[e][g.id()]={}}if(!c[e][b][a]){c[e][b][a]={callback:h,context:d};this._getIndex(b,[b,e,f,a]);this._getIndex(f,[b,e,f,a])}},dispatchEvent:function(d,a){var c=a.getType(),b;a._target=a._target?a._target:d;a._currentTarget=d;this._dispatchEvents(a,c,d);if(a._bubbles){b=d;while(b&&isFunction(b.parent)&&(b=b.parent())){this._dispatchEvents(a,c,b)}if(b&&b!=OJ){this._dispatchEvents(a,c,OJ)}}},hasEventListener:function(c,b){var a=this._events;if(a[b]&&a[b][c.id()]){return true}return false},_removeEventListener:function(e,f,g,b){var d=this._events,a=this._index,c=e+":"+f+":"+b;if(d[f]&&d[f][e]&&d[f][e][b]){delete d[f][e][b];if(isEmptyObject(d[f][e])){delete d[f][e];if(isEmptyObject(d[f])){delete d[f]}}}if(a[e]&&a[e][c]){delete a[e][c];if(isEmptyObject(a[e])){delete a[e]}}if(a[g]&&a[g][c]){delete a[g][a];if(isEmptyObject(a[g])){delete a[g]}}},removeAllListeners:function(d){var c=d.id(),b,a;if(b=this._index[c]){for(a in b){this._removeEventListener.apply(this,b[a])}delete this._index[c]}},removeEventListener:function(g,e,d,h){var c=this._events,b=g.id(),f=d.id(),a;if(c[e]){if(c[e][b]){if(h=isString(h)?d[h]:h){a=f+":"+h.guid;if(c[e][b][a]){this._removeEventListener(b,e,f,a)}}}}}});