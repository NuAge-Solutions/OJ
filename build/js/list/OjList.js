OJ.importJs("oj.components.OjComponent");OJ.importJs("oj.data.OjCollection");OJ.importJs("oj.list.OjListItem");OJ.importJs("oj.list.OjListEvent");OJ.importCss("oj.list.OjList");"use strict";OJ.extendComponent("OjList",[OjView],{_props_:{dataProvider:null,direction:"vertical",itemRenderer:OjListItem},_constructor:function(){var a=arguments,b=arguments.length;this._super(OjView,"_constructor",[]);this.addCss(["vertical"]);this.container.addCss(["items","cf"]);this._item_events={};if(b){if(b>1){this.setItemRenderer(a[1]);if(b>2){this.setDirection(a[2])}}this.setDataProvider(a[0])}else{this.setDataProvider(new OjCollection())}},_createItem:function(d,a){var b,c=new this._itemRenderer(this,d);this.addElmAt(c,a);for(b in this._item_events){c.addEventListener(b,this,this._item_events[b])}return this._redrawItem(c,d,a)},_destroyItem:function(a){OJ.destroy(this.removeElmAt(a),true)},_redrawItem:function(b,c,a){if(!b){return}this._updateClasses(b,a);b.setData(c);return b},_redrawItems:function(){var c=this.numItems(),b=this.numElms(),d=c-b,a;if(d>0){for(a=0;a<d;a++){this._createItem(this.getItemAt(b+a),b+a)}}else{if(d<0){for(;b-->c;){this._destroyItem(b)}b=c}}for(;b--;){this._redrawItem(this.getElmAt(b),this.getItemAt(b),b)}},_updateClasses:function(e,b){var a=[];var c=[];var d=this.numItems();if(b==0){a.push("first")}else{c.push("first")}if(b+1==d||d==1){a.push("last")}else{c.push("last")}if(b==0||b%2==0){a.push("even");c.push("odd")}else{a.push("odd");c.push("even")}e.addCss(a);e.removeCss(c)},redraw:function(){if(this._super(OjView,"redraw",arguments)){this._redrawItems();return true}return false},redrawItem:function(b){var a=this.indexOfItem(b);this._redrawItem(this.getElmAt(a),b,a)},redrawItemAt:function(a){this._redrawItem(this.getElmAt(a),this.getItemAt(a),a)},addItem:function(a){return this._dataProvider.addItem(a)},addItemAt:function(b,a){return this._dataProvider.addItemAt(b,a)},getItemAt:function(a){return this._dataProvider.getItemAt(a)},indexOfItem:function(a){return this._dataProvider.indexOfItem(a)},hasItem:function(a){return this._dataProvider.hasItem(a)},numItems:function(){return this._dataProvider.numItems()},removeItem:function(a){return this._dataProvider.removeItem(a)},removeItemAt:function(a){return this._dataProvider.removeItemAt(a)},addEventListener:function(b,e,d){var c,f,a;if(b==OjListEvent.ITEM_CLICK){f=OjMouseEvent.CLICK;a="_onItemClick"}else{if(b==OjListEvent.ITEM_OVER){f=OjMouseEvent.OVER;a="_onItemOver"}else{if(b==OjListEvent.ITEM_OUT){f=OjMouseEvent.OUT;a="_onItemOut"}}}if(f&&!this._item_events[f]){c=this.numItems();for(;c--;){this.getElmAt(c).addEventListener(f,this,a)}this._item_events[f]=a}return this._super(OjView,"addEventListener",arguments)},removeEventListener:function(c,f,e){var a=this._super(OjView,"removeEventListener",arguments);if(!this.hasEventListener(c)){var g,b;if(c==OjListEvent.ITEM_CLICK){g=OjMouseEvent.CLICK;b="_onItemClick"}else{if(c==OjListEvent.ITEM_OVER){g=OjMouseEvent.OVER;b="_onItemOver"}else{if(c==OjListEvent.ITEM_OUT){g=OjMouseEvent.OUT;b="_onItemOut"}}}var d=this.numItems();while(d-->0){this.getElmAt(d).removeEventListener(g,this,b)}delete this._item_events[g]}return a},_onItemAdd:function(a){var d=this._createItem(a.getItem(),a.getIndex()),c=this.numItems(),b=Math.max(a.getIndex()-1,0);for(b;b<c;b++){this._updateClasses(this.getElmAt(b),b)}d=c=b=null;this.dispatchEvent(new OjListEvent(OjListEvent.ITEM_ADD,a.getItem(),a.getIndex()))},_onItemMove:function(a){var d=this.numItems(),b,c;for(;d--;){c=this.getElmAt(d);if(c.getData()==a.getItem()){this.moveElm(c,a.getIndex());if(d>a.getIndex()){b=a.getIndex()}else{b=d;d=a.getIndex()}for(;d-->b;){this._updateClasses(this.getElmAt(d),d)}break}}this.dispatchEvent(new OjListEvent(OjListEvent.ITEM_MOVE,a.getItem(),a.getIndex()))},_onItemRemove:function(a){this._destroyItem(a.getIndex());var c=this.numItems(),b=Math.max(a.getIndex()-1,0);for(b;b<c;b++){this._updateClasses(this.getElmAt(b),b)}this.dispatchEvent(new OjListEvent(OjListEvent.ITEM_REMOVE,a.getItem(),a.getIndex()))},_onItemReplace:function(a){this._redrawItem(this.getElmAt(a.getIndex()),a.getItem(),a.getIndex());this.dispatchEvent(new OjListEvent(OjListEvent.ITEM_REPLACE,a.getItem(),a.getIndex()))},_onItemClick:function(a){var b=this.indexOfElm(a.getCurrentTarget());this.dispatchEvent(new OjListEvent(OjListEvent.ITEM_CLICK,this._dataProvider.getItemAt(b),b))},_onItemOver:function(a){var b=this.indexOfElm(a.getCurrentTarget());this.dispatchEvent(new OjListEvent(OjListEvent.ITEM_OVER,this._dataProvider.getItemAt(b),b))},_onItemOut:function(a){var b=this.indexOfElm(a.getCurrentTarget());this.dispatchEvent(new OjListEvent(OjListEvent.ITEM_OUT,this._dataProvider.getItemAt(b),b))},setDataProvider:function(a){if(this._dataProvider==a){return}if(this._dataProvider){this._dataProvider.removeEventListener(OjCollectionEvent.ITEM_ADD,this,"_onItemAdd");this._dataProvider.removeEventListener(OjCollectionEvent.ITEM_MOVE,this,"_onItemMove");this._dataProvider.removeEventListener(OjCollectionEvent.ITEM_REMOVE,this,"_onItemRemove");this._dataProvider.removeEventListener(OjCollectionEvent.ITEM_REPLACE,this,"_onItemReplace")}this._dataProvider=OjCollection.collection(a);if(!this._dataProvider){this._dataProvider=new OjCollection()}this._dataProvider.addEventListener(OjCollectionEvent.ITEM_ADD,this,"_onItemAdd");this._dataProvider.addEventListener(OjCollectionEvent.ITEM_MOVE,this,"_onItemMove");this._dataProvider.addEventListener(OjCollectionEvent.ITEM_REMOVE,this,"_onItemRemove");this._dataProvider.addEventListener(OjCollectionEvent.ITEM_REPLACE,this,"_onItemReplace");this.redraw(true)},setDirection:function(a){if(this._direction!=a){if(this._direction){this.container.removeCss([this._direction])}this.container.addCss([this._direction=a])}},setItemRenderer:function(a){this._itemRenderer=isString(a)?window[a]:a}},{HORIZONTAL:"horizontal",VERTICAL:"vertical",_TAGS:["list"]});