OJ.importJs("oj.events.OjActionable");OJ.importJs("oj.events.OjEvent");OJ.importJs("oj.events.OjErrorEvent");OJ.importJs("oj.events.OjIoErrorEvent");OJ.importJs("oj.net.OjUrlRequest");OJ.importJs("oj.net.OjUrlLoader");"use strict";OJ.extendClass(OjActionable,"OjLibrary",{_props_:{assets:null,async:false},_queue:null,_constructor:function(){this._super("OjLibrary","_constructor",[]);this.setAssets(arguments.length?arguments[0]:{});this._queue={}},_onSuccess:function(a){var c=a.getTarget().id(),b=this._queue[c];if(b){this._assets[b.asset]=a.getTarget().getData();delete this._queue[c]}OJ.destroy(a.getTarget())},_onFail:function(a){var c=a.getTarget().id(),b=this._queue[c];if(b){this.dispatchEvent(new OjErrorEvent(OjErrorEvent.ERROR));delete this._queue[c]}OJ.destroy(a.getTarget())},load:function(b){var d=b.toString(),c=arguments.length>1&&arguments[1];if(!this.isLoaded(d)||c){b=new OjUrlRequest.urlRequest(b);if(c){b.getQueryParam("force",Date.time())}var a=new OjUrlLoader(b,this._async);this._queue[a.id()]={loader:a,asset:d};a.addEventListener(OjEvent.COMPLETE,this,"_onSuccess");a.addEventListener(OjIoErrorEvent.IO_ERROR,this,"_onFail");a.load()}return this._assets[d]},isLoaded:function(a){return this._assets[a.toString()]?true:false},getAsset:function(a){return this._assets[a.toString()]},setAsset:function(a,b){a=a.toString();if(isNull(b)){return delete this._assets[a]}this._assets[a]=b}});