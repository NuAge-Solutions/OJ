OJ.importJs("oj.nav.OjView");OJ.importJs("oj.form.OjFormError");OJ.importJs("oj.list.OjList");OJ.importCss("oj.form.OjForm");"use strict";OJ.extendComponent(OjView,"OjForm",{_template:"oj.form.OjForm",header:null,footer:null,title:null,_data:null,_inputs:null,_errors:null,_compile_:function(){this.getLabel=this.getTitle;this.setLabel=this.setTitle},_constructor:function(){this._data={};this._inputs={};this._errors=[];this._super("OjForm","_constructor",arguments);this.errors.hide();this._processActions()},_processActions:function(){if(this.actions){var b,a=this.actions.numChildren();while(a-->0){b=this.actions.getChildAt(a);if(b.is("OjButton")){b.addEventListener(OjMouseEvent.CLICK,this,"_onActionButtonClick")}}}},_onActionButtonClick:function(a){var b=a.getCurrentTarget();if(b.hasCss(["submit-button"])){this._onSubmit(a)}else{if(b.hasCss(["cancel-button"])){this._onCancel(a)}}},_onSubmit:function(a){this.submit()},_onCancel:function(a){this.dispatchEvent(new OjEvent(OjEvent.CANCEL))},_updateInputs:function(){var b,a=this.find(".OjInput"),c=a.length;this._inputs={};while(c-->0){b=OjForm.parentForm(a[c]);if(b&&b==this){this._inputs[a[c].id]=OJ.elm(a[c])}}},_redraw:function(){},_reset:function(){this._updateInputs();var b,a;for(b in this._inputs){a=this._inputs[b];a.setValue(this._data[a.getName()])}},_submit:function(){},_validate:function(){this._updateInputs();var b,a,c=true;for(b in this._inputs){a=this._inputs[b];if(!a.validate()){this._errors.push({input:a,errors:a.getErrors()});c=false}}return c},redraw:function(){if(this._super("OjForm","redraw",arguments)){this._redraw();return true}return false},reset:function(){this._reset()},submit:function(){this._submit();this.dispatchEvent(new OjEvent(OjEvent.SUBMIT))},validate:function(){this._errors=[];var a=this._validate();this.errors.getDataProvider().setSource(this._errors);if(a){this.errors.hide()}else{this.errors.show()}return a},_addElm:function(b,a){if(b.is("OjInput")){this._inputs[b.id()]=b}this._super("OjForm","_addElm",arguments)},_removeElm:function(a){delete this._inputs[a.id()];this._super("OjForm","_removeElm",arguments)},getData:function(){return this._data},setData:function(a){this._data=a;this._reset()},setError:function(a){this.errors.getDataProvider().addItem({input:null,errors:[a]});this.errors.show()}},{_TAGS:["form"],COMPLETE:"formComplete",parentForm:function(c,b){c=OJ.elm(c);var a,b=arguments.length>1?arguments[0]:OJ;b=OJ.elm(b);while(c&&c!=b){a=c.parent();if(a&&a.is("OjForm")){return a}c=a}return null}});