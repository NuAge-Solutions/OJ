OJ.importJs("oj.dom.OjStyleElement");OJ.importJs("oj.events.OjActionable");OJ.importJs("oj.fx.OjFade");OJ.importJs("oj.nav.OjIframe");OJ.importJs("oj.media.OjImageViewer");OJ.importJs("oj.window.OjModal");OJ.importJs("oj.window.OjAlert");OJ.importCss("oj.window.OjModal");"use strict";OJ.extendManager("WindowManager",OjActionable,"OjWindowManager",{BLANK:"_blank",SELF:"_self",PARENT:"_parent",TOP:"_top",WINDOW:"_window",HIDE:"onWindowHide",SHOW:"onWindowShow",_props_:{alertClass:OjAlert,modalClass:OjModal},_constructor:function(a){this._super("OjWindowManager","_constructor",[]);if(a){this._modals=a._modals;this._modal_holder=a._modal_holder;this._overlay=a._overlay;if(!OJ.isReady()){OJ.removeEventListener(OjEvent.READY,a,"_onOjReady");OJ.addEventListener(OjEvent.READY,this,"_onOjReady")}OJ.destroy(a)}else{this._modals=[];this._modal_holder=new OjStyleElement();this._modal_holder.addCss(["WindowManager"]);this._modal_holder.hide();if(OJ.isReady()){this._onOjReady(null)}else{OJ.addEventListener(OjEvent.READY,this,"_onOjReady")}}},_alert:function(g,f){var a=arguments,e=a.length,d=e>2?a[2]:[],c="Ok",b;if(e>3){c=a[3]}else{if(e>2){c="Cancel"}}b=this.makeAlert(g,f,d,c);if(!d&&!c){b.hideButtons()}b.setPaneWidth(400);return b},_calcBrowserWidth:function(){var a=OJ.getViewport();if(OJ.isMobile()){return a.width}if(OJ.isTablet()&&a.width>540){return 540}return Math.round(a.width*0.85)},_calcBrowserHeight:function(){var a=OJ.getViewport();if(OJ.isMobile()){return a.height}if(OJ.isTablet()&&a.height>620){return 620}return Math.round(a.height*0.85)},_isMobileModal:function(a){return a.is("OjModal")&&OJ.isMobile()},_transIn:function(b){var c=new OjFade(b,OjFade.IN),e=b.pane,a,d;c.addEventListener(OjTweenEvent.COMPLETE,this,"_onShow");c.start();if(this._isMobileModal(b)){a=e.getHeight();d=e.getY();e.setY(d+a);c=new OjMove(e,OjMove.Y,d,250,OjEasing.OUT);c.start()}},_transOut:function(b){var c=new OjFade(b,OjFade.OUT),e=b.pane,a,d;c.addEventListener(OjTweenEvent.COMPLETE,this,"_onHide");c.start();if(this._isMobileModal(b)){a=e.getHeight();d=e.getY();c=new OjMove(b.pane,OjMove.Y,d+a,250,OjEasing.OUT);c.start()}},_onShow:function(a){var b=a.getCurrentTarget().getTarget();a=OJ.destroy(a);b.dispatchEvent(new OjEvent(this.SHOW))},_onHide:function(a){var b=this._modal_holder,c=a.getCurrentTarget().getTarget();b.removeChild(c);a=OJ.destroy(a);if(!b.numChildren()){b.hide()}c.dispatchEvent(new OjEvent(this.HIDE));if(c.getSelfDestruct()){OJ.destroy(c,c.getSelfDestruct())}},_onOjReady:function(a){OJ.removeEventListener(OjEvent.READY,this,"_onOjReady");document.body.appendChild(this._modal_holder.dom());this._modal_holder._setIsDisplayed(true)},alert:function(c,b){var a=this._alert.apply(this,arguments);this.show(a);return a},browser:function(b,f){var a=arguments,e=a.length,c=new OjIframe(b),d=this.makeModal(f,c);c.setWidth(100,"%");c.setHeight(100,"%");d.addCss(["browser"]);d.setSelfDestruct(OjAlert.DEEP);d.setPaneWidth(e>2?a[2]:this._calcBrowserWidth());d.setPaneHeight(e>3?a[3]:this._calcBrowserHeight());return this.show(d)},position:function(e){var b=e.getWidth(),d=e.getHeight(),a=e.getPaneWidth(),c=e.getPaneHeight();e.pane.setX((b-a)/2);e.pane.setY(((d-c)/2)*0.75)},hide:function(c){var b=this._modals,a;if((a=b.indexOf(c))==-1){return}b.splice(a,1);this._transOut(c)},hideLoading:function(){var b=arguments,a=b.length?b[0]:this._overlay;if(a){a.hide()}},image:function(b,f){var a=arguments,d=a.length,e=new OjImageViewer(b),c=this.makeModal(f,e);e.setWidth(100,"%");e.setHeight(100,"%");c.setSelfDestruct(OjAlert.DEEP);c.setPaneWidth(d>2?a[2]:this._calcBrowserWidth());c.setPaneHeight(d>3?a[3]:this._calcBrowserHeight());return this.show(c)},makeAlert:function(){return this._alertClass.makeNew(arguments)},makeModal:function(){return this._modalClass.makeNew(arguments)},moveToTop:function(a){this._modal_holder.moveChild(a,this._modal_holder.numChildren()-1)},open:function(b){var h=arguments,g=h.length,f=g>1?h[1]:this.BLANK,e=g>2?h[2]:{},d=[],i,c=OJ.getViewport(),a=OJ.getScreen();if(f!=this.SELF&&f!=this.TOP&&f!=this.PARENT){if(isUnset(e.toolbar)){e.toolbar=0}if(!e.width){e.width=c.width*0.75}if(!e.height){e.height=c.height*0.75}if(isUnset(e.top)){e.top=a.top+Math.round((c.height-e.height)/2)}if(isUnset(e.left)){e.left=a.left+Math.round((c.width-e.width)/2)}for(i in e){d.push(i+"="+e[i])}if(f==this.WINDOW){f=OJ.guid()}}window.open(b.toString(),f,d.join(","));return f},show:function(b){var a=this._modal_holder;this._modals.push(b);if(!a.isVisible()){a.show()}b.show();b.setAlpha(0);a.addChild(b);this.position(b);this._transIn(b)},showLoading:function(){var b=arguments,d=b.length,e=d?b[0]:null,c=d>1?b[1]:null,a=this._overlay;if(!a){a=this._overlay=new OjOverlay()}a.setMessage(e);a.setIcon(c);a.show(this._modal_holder);return a},getHolder:function(){return this._modal_holder}});